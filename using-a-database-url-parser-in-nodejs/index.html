<!doctype html><html lang=en-uk>
<head>
<meta charset=utf-8>
<meta name=generator content="Hugo 0.88.0">
<meta name=viewport content="width=device-width,initial-scale=1">
<link href="//fonts.googleapis.com/css?family=Open+Sans:400,800" rel=stylesheet type=text/css>
<link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css>
<link rel=stylesheet href=/css/normalize.css>
<link rel=stylesheet href=/css/skeleton.css>
<link rel=stylesheet href=/css/custom.css>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<title>Using a Database URL Parser in NodeJs | Code Chauffeur</title>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-92329943-4','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<meta property="og:title" content="Using a Database URL Parser in NodeJs">
<meta property="og:description" content="One of the points in The Twelve-Factor App is Config.
An app’s config is everything that is likely to vary between deploys (staging, production, developer environments, etc). Most applications that require persistent storage use databases. Applications connect to databases using certain parameters and credentials which are usually stored in a type of Config. The database config usually includes a database driver, port, name, username and password.
You must have seen one/more of these env variables in projects:">
<meta property="og:type" content="article">
<meta property="og:url" content="https://codechauffeur.com/using-a-database-url-parser-in-nodejs/"><meta property="og:image" content="https://codechauffeur.com/images/database-url-parser/cover.png"><meta property="article:section" content="articles">
<meta property="article:published_time" content="2020-05-24T09:13:37+01:00">
<meta property="article:modified_time" content="2020-05-24T09:13:37+01:00"><meta property="og:site_name" content="Code Chauffeur">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://codechauffeur.com/images/database-url-parser/cover.png">
<meta name=twitter:title content="Using a Database URL Parser in NodeJs">
<meta name=twitter:description content="One of the points in The Twelve-Factor App is Config.
An app’s config is everything that is likely to vary between deploys (staging, production, developer environments, etc). Most applications that require persistent storage use databases. Applications connect to databases using certain parameters and credentials which are usually stored in a type of Config. The database config usually includes a database driver, port, name, username and password.
You must have seen one/more of these env variables in projects:">
<meta itemprop=name content="Using a Database URL Parser in NodeJs">
<meta itemprop=description content="One of the points in The Twelve-Factor App is Config.
An app’s config is everything that is likely to vary between deploys (staging, production, developer environments, etc). Most applications that require persistent storage use databases. Applications connect to databases using certain parameters and credentials which are usually stored in a type of Config. The database config usually includes a database driver, port, name, username and password.
You must have seen one/more of these env variables in projects:"><meta itemprop=datePublished content="2020-05-24T09:13:37+01:00">
<meta itemprop=dateModified content="2020-05-24T09:13:37+01:00">
<meta itemprop=wordCount content="242"><meta itemprop=image content="https://codechauffeur.com/images/database-url-parser/cover.png">
<meta itemprop=keywords content="NodeJs,Database,12Factor,env,url,">
</head>
<body>
<div class=container>
<header role=contentinfo>
<div class=header-links>
<a href=/>Home</a> /
<a href=/articles/>Articles</a> /
<a href=/contact/>Contact</a> /
<a href=/portfolio/>Portfolio</a> /
<a href=/podcast/>Podcast</a> /
</div>
</header>
<header role=banner>
<h1>Using a Database URL Parser in NodeJs</h1>
</header>
<div id=content>
<style>code{background:initial;border:none}</style>
<main role=main>
<div>
<article id=content>
<p>One of the points in <a href=https://12factor.net/>The Twelve-Factor App</a> is <code>Config</code>.</p>
<p>An app’s config is everything that is likely to vary between deploys (staging, production, developer environments, etc). Most applications that require persistent storage use databases. Applications connect to databases using certain parameters and credentials which are usually stored in a type of <code>Config</code>. The database config usually includes a database driver, port, name, username and password.</p>
<p>You must have seen one/more of these env variables in projects:</p>
<ul>
<li>DB_CONNECTION</li>
<li>DB_HOST</li>
<li>DB_PORT</li>
<li>DB_USER</li>
<li>DB_PASSWORD</li>
<li>DB_DATABASE</li>
</ul>
<p>These separate env variables can be combined into a single variable using a URL parser. <a href=https://www.npmjs.com/package/parse-database-url>parse-database-url</a> is a simple NodeJs library that parses database configurations passed in as URLs.</p>
<p>You can name the single combined variable <code>DATABASE_URL</code>. The structure of the <code>DATABASE_URL</code> is:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>DATABASE_URL<span style=color:#f92672>=</span>driver://username:password@hostname:port/database_name
</code></pre></div><p>An example is:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>DATABASE_URL<span style=color:#f92672>=</span>mysql://root:password123@localhost:3306/app_db
</code></pre></div><p>To use the library, simply install with npm:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>npm install parse-database-url
</code></pre></div><p>Import the library and parse the <code>DATABASE_URL</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>parseDbUrl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;parse-database-url&#34;</span>);
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dbConfig</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>parseDbUrl</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>DATABASE_URL</span>);
</code></pre></div><p><code>dbConfig</code> is an object with the database configurations. You can apply this to wherever you set <code>Config</code> in your application.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{
  <span style=color:#e6db74>&#34;driver&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;mysql&#34;</span>,
  <span style=color:#e6db74>&#34;user&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;root&#34;</span>,
  <span style=color:#e6db74>&#34;password&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;password123&#34;</span>,
  <span style=color:#e6db74>&#34;host&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;localhost&#34;</span>,
  <span style=color:#e6db74>&#34;port&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;3306&#34;</span>,
  <span style=color:#e6db74>&#34;database&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;app_db&#34;</span>
}
</code></pre></div><p>By using this process, you reduce the number of env variables.</p>
<p>Note: There are some known issues with this method. If your database password contains some special characters, it&rsquo;ll break the parsing and the result will be inconsistent. Also, if you put a non-existing driver, the library does not validate it.</p>
</article>
</div>
<aside id=meta>
<div>
<section>
<span class=entry-meta><time itemprop=datePublished datetime=2020-05-24>May 24, 2020 | 242 Words</time></span>
</section>
<ul id=tags>
<li> <a href=https://codechauffeur.com/tags/nodejs>NodeJs</a> </li>
<li> <a href=https://codechauffeur.com/tags/database>Database</a> </li>
<li> <a href=https://codechauffeur.com/tags/12factor>12Factor</a> </li>
<li> <a href=https://codechauffeur.com/tags/env>env</a> </li>
<li> <a href=https://codechauffeur.com/tags/url>url</a> </li>
</ul>
</div>
<div>
<a class=previous href=https://codechauffeur.com/convert-string-case-easily-in-vs-code-with-this-extension/> Convert String Case Easily in VS Code with this Extension</a> |
<a class=next href=https://codechauffeur.com/easy-deployment-setup-with-bitbucket-and-aws-ecs/> Easy Deployment Setup With Bitbucket and AWS ECS</a>
</div>
</aside>
</main>
</div>
<footer role=contentinfo>
<div class=hr></div>
<div class=footer-links>
<a href=http://twitter.com/olaoluwa_98>Twitter</a> /
<a href=https://github.com/olaoluwa-98>GitHub</a> /
<a href=mailto:awotunde.emmanuel1@gmail.com target=_blank>Email</a> /
<a href=/articles/index.xml>RSS</a> /
</div>
<div class=copyright>© Emmanuel Awotunde</div>
</footer>
<script src=https://unpkg.com/medium-zoom@1.0.4/dist/medium-zoom.min.js></script>
<script>mediumZoom(document.querySelectorAll('img'))</script></div>
</body>
</html>